!function(){var e="",a="",d="",t="",s={init:function(){s.citySelect(),s.CompileAds(),s.addAddress(),s.savaAds()},validate:function(e){var a="",d=e.valTrim(),t=e.attr("id"),s=e.html().indexOf("请选择");switch(t){case"name":""===d&&(a="请输入收货人姓名");break;case"phone":""===d?a="请输入收货人手机号":d.match(/^1[34578]\d{9}$/)||(a="请输入正确的手机号");break;case"sel_city":s>=0&&(a="请选择收货地区");break;case"detailAddress":""===d&&(a="请输入详细门牌号")}return""!=a?(layer.msg(a),e.addClass("border-error"),!1):(e.removeClass("border-error"),!0)},addAddress:function(){$(".add-btn").on("click",function(){var n;$(":input,a",".zy-address-add").each(function(){if(!(n=s.validate($(this))))return n}),s.defualtCheck(),n&&$.ajaxByPost("receiveAddress/insert",{provinceNumber:e,cityNumber:a,areaNumber:d,addressInfo:$("#detailAddress").valTrim(),addressRemark:"",token:MyLocalStorage.Cache.get("token"),addressName:$("#name").valTrim(),addressTelephone:$("#phone").valTrim(),addressComplete:$("#sel_city").html()+$("#detailAddress").valTrim(),addressDefault:t},function(e){200==e.code?(console.log(e),window.location.href="addressManage.html"):layer.msg(e.detailMessage)})})},CompileAds:function(){$.ajaxByPost("receiveAddress/findByAddressId",{token:MyLocalStorage.Cache.get("token"),addressId:$.getUrlParam("addressId")},function(e){var a;200==e.code?(console.log(e),e.data.addressComplete&&(a=e.data.addressComplete.replace(e.data.addressInfo," ")),$("#name").val(e.data.addressName),$("#phone").val(e.data.addressTelephone),$("#sel_city").html(a),$("#detailAddress").val(e.data.addressInfo),1==e.data.addressDefault?($("#defaultSelect").prop("checked",!0),$(".ids").addClass("zy-select")):($("#defaultSelect").prop("checked",!1),$(".ids").removeClass("zy-select")),s.defualtCheck()):layer.msg(e.detailMessage)}),1==$.getUrlParam("add")?$("#addBtn").addClass("add-btn"):$("#addBtn").addClass("sava-btn")},defualtCheck:function(){$(".default-li").on("click",function(){$(this).find("#defaultSelect").is(":checked")?(t=0,$(this).find(".ids").removeClass("zy-select")):(t=1,$(this).find(".ids").addClass("zy-select"))})},savaAds:function(){$(".sava-btn").on("click",function(){var t,n=!0;$("input",".zy-address-add").each(function(){return n=s.validate($(this))}),t=$("#defaultSelect").is(":checked")?1:0,n&&$.ajaxByPost("receiveAddress/update",{provinceNumber:e,cityNumber:a,areaNumber:d,addressInfo:$("#detailAddress").valTrim(),addressRemark:"",token:MyLocalStorage.Cache.get("token"),addressId:$.getUrlParam("addressId"),addressName:$("#name").valTrim(),addressTelephone:$("#phone").valTrim(),addressComplete:$("#sel_city").html()+$("#detailAddress").valTrim(),addressDefault:t},function(e){200==e.code?(console.log(e),window.location.href="addressManage.html"):layer.msg(e.detailMessage)})})},citySelect:function(){$("#sel_city").on("click",function(){layer.open({type:1,anim:2,skin:"layui-layer-demo",area:["90%","130px"],title:"地址选择",shadeClose:!0,closeBtn:0,content:'<aside class="zy-province"><select id="province">                    <option value="">选择省</option></select><select id="city">                    <option value="">选择市</option></select>                    <select id="area"><option>选择区</option></select></aside>',skin:"footer",success:function(){s.addressChange()},end:function(){}})})},addressChange:function(){$.ajaxByPost("area/findArea",{provincePid:0},function(e){var a="";if(200==e.code){console.log(e);for(var d=0;d<e.data.length;d++)a+="<option value="+e.data[d].provinceId+">"+e.data[d].provinceName+"</option>";$("#province").append(a),console.log(e)}else layer.msg(e.detailMessage)}),$("#province").on("change",function(){e=$(this).val(),$.ajaxByPost("area/findArea",{provincePid:$(this).val()},function(e){for(var a="",d=0;d<e.data.length;d++)a+='<option  value="'+e.data[d].provinceId+'">'+e.data[d].provinceName+"</option>";$("#city").append(a)})}),$("#city").on("change",function(){a=$(this).val(),$.ajaxByPost("area/findArea",{provincePid:$(this).val()},function(e){if(e.data.length<1){var a=$("#province option:selected").text()+" "+$("#city option:selected").text();$("#sel_city").html(a),layer.closeAll()}else{for(var d="",t=0;t<e.data.length;t++)d+="<option  value="+e.data[t].provinceId+">"+e.data[t].provinceName+"</option>";$("#area").append(d)}})}),$("#area").on("change",function(){d=$(this).val();var e=$("#province option:selected").text()+" "+$("#city option:selected").text()+" "+$("#area option:selected").text();$("#sel_city").html(e),layer.closeAll()})}};$(s.init)}();