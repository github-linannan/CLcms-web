!function(){String.prototype.temp=function(o){return this.replace(/\$\w+\$/gi,function(e){var t=o[e.replace(/\$/g,"")];return t+""=="undefined"?"":t})};var o=$("textarea").val(),e={type:["1",!1,0]},t="",a={page:"1",pageSize:"2",goodsName:"",goodsTypeId:t},n=($(".product-search-text").val(),window.location.href),d=$.getUrlArgs(n).type;console.log(d),$(".display-cart img").on("click",function(){null==checkLogin||""==checkLogin?layer.msg("请先登录",{time:500},function(){window.location.href="login.html"}):window.location.href="shoppingCart.html"});var i={init:function(){i.addShop(),$(".product-search-btn").on("click",i.searchShop),$(".product-search-text").bind("input porpertychange",function(){i.searchShop()})},addShop:function(){$.ajaxByPost("goodsType/findGoodsTypeAll",{},function(n){var i=n.data,s="",r="";$.each(i,function(o,n){e["type"+n.goodstypeId]=["1",!1,0],d&&d==n.goodstypeName?(s+='<li class="swiper-slide active" data="'+n.goodstypeId+'" id="active"><a href="#">'+n.goodstypeName+"</a></li>",$(".swiper-wrapper > li").eq(0).removeAttr("id"),$(".swiper-wrapper > li").eq(0).removeClass("active"),t=n.goodstypeId,a.goodsTypeId=n.goodstypeId):s+='<li class="swiper-slide" data="'+n.goodstypeId+'"><a href="#">'+n.goodstypeName+"</a></li>",r+='<ul class="product-cont display-none" id="product'+n.goodstypeId+'"></ul>'}),$(".swiper-wrapper").append(s),$("article").append(r);var p=$(".product-list").dropload({scrollArea:window,domDown:{domClass:"dropload-down",domRefresh:'<div class="dropload-refresh">上拉加载更多</div>',domLoad:'<div class="dropload-load"><span class="loading"></span>加载中...</div>',domNoData:'<div class="dropload-noData">已无数据</div>'},loadDownFn:function(n){$.ajaxByPost("goods/findGoodsList",a,function(d){e["type"+t][0]=(parseInt(e["type"+t][0])+1).toString(),console.log("args"),console.log(a),console.log(e);var i=d.data.product;console.log(d);var s="";0!=i.length?i.forEach(function(e,t){s+=o.temp(e)}):e["type"+t][1]=!0,s=s.replace(/#\w+#/gi,function(o){return MinImgUrl}),setTimeout(function(){$("#product"+a.goodsTypeId).append(s),n.resetload()},1e3)})}});nav("swiper_nav"),$("#swiper_nav > ul > li").click(function(){$(this).addClass("active"),$(this).siblings("li").removeClass("active"),$(this).attr("id","active"),$(this).siblings("li").removeAttr("id"),nav("swiper_nav"),t=$(this).attr("data"),$("#product"+t).removeClass("display-none").siblings(".product-cont").addClass("display-none"),a.page=e["type"+t][0],a.goodsTypeId=t,e["type"+t][2]=$(window).scrollTop(),$(window).scrollTop(e["type"+t][2]),e["type"+t][1]?(p.lock("down"),p.noData()):(p.unlock(),p.noData(!1)),p.resetload()})})},addShopinfo:function(){$.ajaxByPost("goods/findGoodsList",a,function(n){e["type"+t][0]=(parseInt(e["type"+t][0])+1).toString(),console.log("args"),console.log(a),console.log(e);var d=n.data.product;console.log(n);var i="";0!=d.length?d.forEach(function(e,t){i+=o.temp(e)}):e["type"+t][1]=!0,i=i.replace(/#\w+#/gi,function(o){return MinImgUrl}),$("#product"+a.goodsTypeId).append(i)})},scrollAdd:function(a){var n=layer.load(),d={page:e["type"+t][0],pageSize:"6",goodsTypeId:a};$.ajaxByPost("goods/findGoodsList",d,function(a){var d=a.data.product;console.log(a);var i="";d&&(layer.close(n),d.forEach(function(e,t){i+=o.temp(e)}),e["type"+t][0]=(parseInt(e["type"+t][0])+1).toString(),console.log(e)),i=i.replace(/#\w+#/gi,function(o){return MinImgUrl}),$("#product"+t).append(i)})},searchShop:function(){var o=$(".product-search-text").val();a.goodsName=o,i.addShopinfo()}};$(i.init)}();