!function(){var t=window.location.href,e=$.getUrlArgs(t).categoryid,o=$(".product-detail-mask"),i=$(".product-detail-select-btn"),a=$(".product-detail-cart"),n=$(".product-detail-buy");$jian=$("#jian"),$jia=$("#jia"),String.prototype.temp=function(t){return this.replace(/\$\w+\$/gi,function(e){var o=t[e.replace(/\$/g,"")];return o+""=="undefined"?"":o})};var l=parseInt($(".hl-detail").get(0).offsetHeight),c=$("#detail-cont").val();$("a").on("click",function(){var t=$(this).attr("class");$(this).parent().siblings().removeClass("select-style"),$(this).parent().addClass("select-style"),document.getElementById(t).scrollIntoView()}),$(".display-cart img").on("click",function(){null==checkLogin||""==checkLogin?layer.msg("请先登录",{time:500},function(){window.location.href="login.html"}):window.location.href="shoppingCart.html"});var s={init:function(){var t={goodsId:e};s.addShopinfo(t),$(window).trigger("scroll"),$(window).on("scroll",s.scrollPosition),a.on("click",s.cartBtn),n.on("click",s.buyBtn),$(".cart-close").on("click",s.selectHide),o.on("click",s.selectHide),$jian.on("click",function(){s.calculateNum(1)}),$jia.on("click",function(){s.calculateNum(2)})},addShopinfo:function(t){var e="",o="";$.ajaxByPost("goods/findByGoodsId",t,function(t){for(var i=t.data,a=[i.goodsImageOne,i.goodsImageTwo,i.goodsImageThree,i.goodsImageFour,i.goodsImage1Five],n=0;n<a.length;n++)""!=a[n]&&(o+='<div class="swiper-slide"><a href=""><img src="'+img_url+a[n]+'"></a></div>');$(".swiper-wrapper").html(o),e=c.temp(i),$(".product-detail-cont").html(e),$("#select-img").attr("src",MinImgUrl+i.goodsImageOne),$("#select-price").html(i.goodsDiscountPrice);new Swiper(".swiper-container",{autoplay:{delay:5e3},pagination:{el:".swiper-pagination",dynamicBullets:!0}})}),$.ajaxByPost("goodsInfo/findGoodsInfoList",t,function(t){var e=t.data;if(""!=e.goodsinfoDetails){var o=e.goodsinfoDetails.replace(/weditor/g,img_url);o=o.replace(/<table/g,'<table class="product-detail-table"'),$(".product-detail-detail").append(o),$(".product-detail-detail p img").parents("p").addClass("product-detail-imgp")}})},scrollPosition:function(){var t=$(document).scrollTop(),e=$(".product-detail-cont").offset().top,o=$(".product-detail-banner").offset().top,i=$("#product-detail-list li"),a=$(".product-detail-nav"),n=t/e;n=n.toFixed(2),0<=t&&t<10?a.css({opacity:0,"z-index":-1}):o<=t&&t<e?(i.eq(0).addClass("select-style").siblings().removeClass("select-style"),a.css({opacity:n,"z-index":2})):e<=t&&t<$(".hl-detail").offset().top-l?(i.eq(0).addClass("select-style").siblings().removeClass("select-style"),a.css({opacity:1,"z-index":2})):$(".hl-detail").offset().top-l<=t?(i.eq(1).addClass("select-style").siblings().removeClass("select-style"),a.css({opacity:1,"z-index":2})):(i.removeClass("select-style"),a.css({opacity:1,"z-index":2}))},selectShow:function(){var t=$(".product-detail-mask"),e=$(".product-detail-select");t.show(),e.animate({bottom:"0"},500)},selectHide:function(){var t=$(".product-detail-mask"),e=$(".product-detail-select"),o=$(".product-detail-select-img"),i=e.height()-o.position().top;t.hide(),e.animate({bottom:"-"+i+"px"},200)},calculateNum:function(t){var e=parseInt($("#num").html());1==t?e-=1:2==t&&(e+=1),e<=0&&(e=1),$("#num").html(e)},addCart:function(){s.selectHide();var t={token:checkLogin,goodsId:e,count:parseInt($("#num").html())};$.ajaxByPost("shopingCart/addOrUpdateCart",t,function(t){200==t.code&&(layer.msg("已加入购物车"),$(".display-cart span").addClass("cart-span-bg"))})},cartBtn:function(){null==checkLogin||""==checkLogin?layer.msg("请先登录",{time:500},function(){window.location.href="login.html"}):(s.selectShow(),i.unbind("click",s.goOrder),i.on("click",s.addCart))},buyBtn:function(){null==checkLogin||""==checkLogin?layer.msg("请先登录",{time:500},function(){window.location.href="login.html"}):(s.selectShow(),i.unbind("click",s.addCart),i.on("click",s.goOrder))},goOrder:function(){window.location.href="submitOrder.html?categoryid="+e+"&num="+parseInt($("#num").html())},addImage:function(t,e){}};$(s.init)}();